<?php
/**
 * Template Name: Página Fale Conosco
 * Description: Página de contato com formulário e informações.
 *
 * @package TemaAromas
 * @version 1.0.0
 */

get_header(); ?>

<div class="luxury-container">
    <main id="main" class="site-main">
        <article id="page-fale-conosco" class="page-content luxury-page">
            
            <!-- Simple Page Header -->
            <section class="page-header-section luxury-section">
                <div class="container">
                    <div class="page-header-content text-center animate-fade-in-up">
                        <h1 class="page-title luxury-heading">Fale Conosco</h1>
                        <p class="page-subtitle">
                            Estamos aqui para ajudar você a encontrar o aroma perfeito para seu ambiente
                        </p>
                    </div>
                </div>
            </section>

            <!-- Main Contact Section - Two Columns -->
            <section class="contact-main-section">
                <div class="contact-two-columns">
                    
                    <!-- Left Column - Contact Information -->
                    <div class="contact-info-column">
                        <div class="contact-methods-title">
                            <h2>Escolha seu canal favorito</h2>
                            <p>Estamos disponíveis em diversos canais</p>
                        </div>
                        
                        <div class="contact-methods-list">
                            <a href="mailto:secretszen888@gmail.com" class="contact-method-item contact-method-link">
                                <div class="contact-method-icon email-icon">
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                                    </svg>
                                </div>
                                <div class="contact-method-content">
                                    <h3>E-mail</h3>
                                    <p>secretszen888@gmail.com</p>
                                    <small>Resposta em até 24h úteis</small>
                                </div>
                            </a>

                            <a href="https://wa.me/5516991626921" target="_blank" rel="noopener noreferrer" class="contact-method-item contact-method-link">
                                <div class="contact-method-icon whatsapp-icon">
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                                    </svg>
                                </div>
                                <div class="contact-method-content">
                                    <h3>WhatsApp</h3>
                                    <p>(16) 99162-6921</p>
                                    <small>Atendimento em horário comercial</small>
                                </div>
                            </a>

                            <a href="https://www.instagram.com/secretszen" target="_blank" rel="noopener noreferrer" class="contact-method-item contact-method-link">
                                <div class="contact-method-icon instagram-icon">
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                    </svg>
                                </div>
                                <div class="contact-method-content">
                                    <h3>Instagram</h3>
                                    <p>@secretszen</p>
                                    <small>Siga-nos para novidades e dicas</small>
                                </div>
                            </a>
                        </div>
                    </div>

                    <!-- Right Column - Contact Form -->
                    <div class="contact-form-column">
                        <div class="contact-form-title">
                            <h2>Envie sua mensagem</h2>
                            <p>Preencha o formulário abaixo e entraremos em contato o mais breve possível</p>
                        </div>

                        <div class="contact-form-container-modern">
                    <?php
                    // Check for Formspree success
                    if (isset($_GET['success']) && '1' === sanitize_text_field($_GET['success'])) {
                        echo '<div class="contact-success"><p>Mensagem enviada com sucesso! Entraremos em contato em breve.</p></div>';
                    }
                    
                    // Check if form was submitted (fallback to WordPress handling)
                    if (isset($_POST['contact_form_submit']) && wp_verify_nonce($_POST['contact_form_nonce'], 'contact_form_action')) {
                        
                        // Sanitize form data
                        $name = sanitize_text_field($_POST['contact_name']);
                        $email = sanitize_email($_POST['contact_email']);
                        $phone = sanitize_text_field($_POST['contact_phone']);
                        $subject = sanitize_text_field($_POST['contact_subject']);
                        $message = sanitize_textarea_field($_POST['contact_message']);
                        
                        // Validate required fields
                        $errors = array();
                        if (empty($name)) $errors[] = 'Nome é obrigatório';
                        if (empty($email) || !is_email($email)) $errors[] = 'E-mail válido é obrigatório';
                        if (empty($message)) $errors[] = 'Mensagem é obrigatória';
                        
                        if (empty($errors)) {
                            // Send email
                            $to = get_option('admin_email');
                            $email_subject = 'Contato do site - ' . $subject;
                            $email_message = "Nome: $name\n";
                            $email_message .= "E-mail: $email\n";
                            $email_message .= "Telefone: $phone\n";
                            $email_message .= "Assunto: $subject\n\n";
                            $email_message .= "Mensagem:\n$message";
                            
                            $headers = array(
                                'Content-Type: text/plain; charset=UTF-8',
                                'From: ' . get_bloginfo('name') . ' <' . get_option('admin_email') . '>',
                                'Reply-To: ' . $name . ' <' . $email . '>'
                            );
                            
                            if (wp_mail($to, $email_subject, $email_message, $headers)) {
                                echo '<div class="contact-success"><p>' . esc_html__('Mensagem enviada com sucesso! Entraremos em contato em breve.', 'tema_aromas') . '</p></div>';
                            } else {
                                echo '<div class="contact-error"><p>' . esc_html__('Erro ao enviar mensagem. Tente novamente.', 'tema_aromas') . '</p></div>';
                            }
                        } else {
                            echo '<div class="contact-error"><ul>';
                            foreach ($errors as $error) {
                                echo '<li>' . esc_html($error) . '</li>';
                            }
                            echo '</ul></div>';
                        }
                    }
                    ?>
                    
                            <form action="https://formspree.io/f/xovlkqqz" method="post" class="contact-form-modern" novalidate>
                                <?php wp_nonce_field('contact_form_action', 'contact_form_nonce'); ?>
                                
                                <!-- Hidden fields for Formspree -->
                                <input type="hidden" name="_subject" value="Novo contato do site Zen Secrets">
                                <input type="hidden" name="_next" value="<?php echo home_url('/fale-conosco?success=1'); ?>">
                                
                                <div class="form-row-modern">
                                    <div class="form-group-modern">
                                        <label for="contact_name">Nome completo*</label>
                                        <div class="input-with-icon">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                                <circle cx="12" cy="7" r="4"/>
                                            </svg>
                                            <input type="text" id="contact_name" name="name" required 
                                                   value="<?php echo isset($_POST['name']) ? esc_attr($_POST['name']) : ''; ?>"
                                                   class="modern-form-input" placeholder="Digite seu nome">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group-modern">
                                        <label for="contact_email">E-mail*</label>
                                        <div class="input-with-icon">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                                <polyline points="22,6 12,13 2,6"/>
                                            </svg>
                                            <input type="email" id="contact_email" name="email" required 
                                                   value="<?php echo isset($_POST['email']) ? esc_attr($_POST['email']) : ''; ?>"
                                                   class="modern-form-input" placeholder="seu@email.com">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group-modern">
                                    <label for="contact_phone">Telefone (opcional)</label>
                                    <div class="input-with-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                        </svg>
                                        <input type="tel" id="contact_phone" name="phone" 
                                               value="<?php echo isset($_POST['phone']) ? esc_attr($_POST['phone']) : ''; ?>"
                                               class="modern-form-input" placeholder="(00) 00000-0000">
                                    </div>
                                </div>
                                
                                <div class="form-group-modern">
                                    <label for="contact_subject">Assunto*</label>
                                    <select id="contact_subject" name="subject" class="modern-form-input" required>
                                        <option value="">Selecione um assunto</option>
                                        <option value="Dúvidas sobre produtos" <?php selected(isset($_POST['subject']) ? $_POST['subject'] : '', 'Dúvidas sobre produtos'); ?>>Dúvidas sobre produtos</option>
                                        <option value="Pedidos e entregas" <?php selected(isset($_POST['subject']) ? $_POST['subject'] : '', 'Pedidos e entregas'); ?>>Pedidos e entregas</option>
                                        <option value="Trocas e devoluções" <?php selected(isset($_POST['subject']) ? $_POST['subject'] : '', 'Trocas e devoluções'); ?>>Trocas e devoluções</option>
                                        <option value="Sugestões" <?php selected(isset($_POST['subject']) ? $_POST['subject'] : '', 'Sugestões'); ?>>Sugestões</option>
                                        <option value="Outros" <?php selected(isset($_POST['subject']) ? $_POST['subject'] : '', 'Outros'); ?>>Outros</option>
                                    </select>
                                </div>
                                
                                <div class="form-group-modern">
                                    <label for="contact_message">Mensagem*</label>
                                    <textarea id="contact_message" name="message" rows="6" required 
                                              class="modern-form-input" placeholder="Digite sua mensagem aqui..."><?php echo isset($_POST['message']) ? esc_textarea($_POST['message']) : ''; ?></textarea>
                                </div>
                                
                                <div class="form-actions-modern">
                                    <button type="submit" name="contact_form_submit" class="btn-send-modern">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="22" y1="2" x2="11" y2="13"></line>
                                            <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
                                        </svg>
                                        Enviar mensagem
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </section>

        </article>
    </main>
</div>

<?php get_footer(); ?>
